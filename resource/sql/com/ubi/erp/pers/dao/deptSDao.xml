<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.ubi.erp.pers.dao.DeptSDao">

	<resultMap id="DeptSMap" type="Dept"/>
	
 	<select id="selDeptS" statementType="CALLABLE">
		 {call SP_PERS_DEPTS_SCH(#{compId},#{postCode},#{postName},#{o_cursor, mode=OUT, jdbcType=CURSOR, resultMap=DeptSMap, javaType=ResultSet})}	
	</select>
 
  	<insert id="crudDeptS" statementType="CALLABLE" parameterType="Dept">
  		{call SP_PERS_DEPTS_SAVE(#{cudKey},#{compId},#{postCode},#{stDate},#{endDate},#{postName},#{costKind},#{sysEmpNo},#{postNameMst})}	
  	</insert>
  	
  	<select id="selDeptCodeS" statementType="CALLABLE">
		 {call SP_PERS_DEPTS_SCH1(#{compId},#{postName},#{o_cursor, mode=OUT, jdbcType=CURSOR, resultMap=DeptSMap, javaType=ResultSet})}	
	</select>

	<select id="totalDeptS" parameterType="Dept" resultType="int">
    select count(*) from TBL_POST_CODE
       <where>
         <choose>
           <when test="postName != null and postName != ''">
              POST_NAME like '%' || #{postName} || '%'
            </when>
          </choose>
       </where>
    </select>

</mapper>
